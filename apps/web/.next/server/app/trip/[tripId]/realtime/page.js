(()=>{var e={};e.id=81,e.ids=[81],e.modules={7849:e=>{"use strict";e.exports=require("next/dist/client/components/action-async-storage.external")},2934:e=>{"use strict";e.exports=require("next/dist/client/components/action-async-storage.external.js")},5403:e=>{"use strict";e.exports=require("next/dist/client/components/request-async-storage.external")},4580:e=>{"use strict";e.exports=require("next/dist/client/components/request-async-storage.external.js")},4749:e=>{"use strict";e.exports=require("next/dist/client/components/static-generation-async-storage.external")},5869:e=>{"use strict";e.exports=require("next/dist/client/components/static-generation-async-storage.external.js")},399:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},4300:e=>{"use strict";e.exports=require("buffer")},2081:e=>{"use strict";e.exports=require("child_process")},6113:e=>{"use strict";e.exports=require("crypto")},2361:e=>{"use strict";e.exports=require("events")},7147:e=>{"use strict";e.exports=require("fs")},3685:e=>{"use strict";e.exports=require("http")},5687:e=>{"use strict";e.exports=require("https")},1808:e=>{"use strict";e.exports=require("net")},2037:e=>{"use strict";e.exports=require("os")},2781:e=>{"use strict";e.exports=require("stream")},4404:e=>{"use strict";e.exports=require("tls")},6224:e=>{"use strict";e.exports=require("tty")},7310:e=>{"use strict";e.exports=require("url")},3837:e=>{"use strict";e.exports=require("util")},9796:e=>{"use strict";e.exports=require("zlib")},9116:()=>{},5292:()=>{},4e3:()=>{},244:()=>{},5903:()=>{},5052:(e,t,r)=>{"use strict";r.r(t),r.d(t,{GlobalError:()=>o.a,__next_app__:()=>d,originalPathname:()=>p,pages:()=>c,routeModule:()=>m,tree:()=>u});var i=r(117),s=r(2994),n=r(4898),o=r.n(n),a=r(6083),l={};for(let e in a)0>["default","tree","pages","GlobalError","originalPathname","__next_app__","routeModule"].indexOf(e)&&(l[e]=()=>a[e]);r.d(t,l);let u=["",{children:["trip",{children:["[tripId]",{children:["realtime",{children:["__PAGE__",{},{page:[()=>Promise.resolve().then(r.bind(r,6699)),"C:\\Users\\HP\\sisimovego\\apps\\web\\src\\app\\trip\\[tripId]\\realtime\\page.tsx"]}]},{}]},{}]},{}]},{layout:[()=>Promise.resolve().then(r.bind(r,1255)),"C:\\Users\\HP\\sisimovego\\apps\\web\\src\\app\\layout.tsx"],"not-found":[()=>Promise.resolve().then(r.t.bind(r,8658,23)),"next/dist/client/components/not-found-error"]}],c=["C:\\Users\\HP\\sisimovego\\apps\\web\\src\\app\\trip\\[tripId]\\realtime\\page.tsx"],p="/trip/[tripId]/realtime/page",d={require:r,loadChunk:()=>Promise.resolve()},m=new i.AppPageRouteModule({definition:{kind:s.x.APP_PAGE,page:"/trip/[tripId]/realtime/page",pathname:"/trip/[tripId]/realtime",bundlePath:"",filename:"",appPaths:[]},userland:{loaderTree:u}})},6519:(e,t,r)=>{Promise.resolve().then(r.bind(r,4409)),Promise.resolve().then(r.bind(r,5754))},4409:(e,t,r)=>{"use strict";r.r(t),r.d(t,{default:()=>y});var i=r(2281),s=r(2493),n=r(8267),o=r(6289),a=r(6482),l=r(5715),u=r(4460),c=r(9116),p=r.n(c);r(5292);let d=p().icon({iconUrl:"/leaflet/marker-icon.png",shadowUrl:"/leaflet/marker-shadow.png",iconAnchor:[12,41]});function m({coords:e}){let t=(0,n.Sx)();return(0,s.useEffect)(()=>{if(!t||!e||0===e.length)return;let r=p().latLngBounds(e);t.fitBounds(r.pad(.15))},[e,t]),null}function x({active:e,position:t}){let r=(0,n.Sx)();return(0,s.useEffect)(()=>{r&&e&&t&&r.setView(t,r.getZoom(),{animate:!0})},[e,t,r]),null}function f({center:e=[0,0],zoom:t=13,markers:r=[],fitBounds:s=!1,children:n,height:c="100%",autoFollow:p=!1,followPosition:d=null}){return i.jsx("div",{style:{height:c,width:"100%"},children:(0,i.jsxs)(o.h,{center:e,zoom:t,scrollWheelZoom:!0,style:{height:"100%",width:"100%"},children:[i.jsx(a.I,{attribution:"\xa9 OpenStreetMap",url:"https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png"}),s&&r.length>0&&i.jsx(m,{coords:r.map(e=>[e.lat,e.lng])}),p&&d&&i.jsx(x,{active:p,position:d}),r.map((e,t)=>i.jsx(l.J,{position:[e.lat,e.lng],children:e.popup&&i.jsx(u.G,{children:e.popup})},t)),n]})})}function g({position:e,driver:t,title:r}){let n=(0,s.useRef)(null),o=p().divIcon({className:"driver-marker",html:`
      <div style="display:flex;flex-direction:column;align-items:center">
        <div style="width:40px;height:40px;border-radius:50%;overflow:hidden;border:2px solid white;box-shadow:0 1px 3px rgba(0,0,0,0.2)">
          <img src="${t?.avatarUrl??"/icons/driver.png"}" style="width:40px;height:40px;object-fit:cover" />
        </div>
        <div style="background:rgba(0,0,0,0.6);color:white;padding:2px 6px;border-radius:6px;margin-top:6px;font-size:11px">
          ${t?.name??r??"Driver"}
        </div>
      </div>
    `,iconSize:[40,58],iconAnchor:[20,58]});return(0,s.useEffect)(()=>{if(!n.current)return;let t=n.current,r=t.getLatLng(),i=p().latLng(e[0],e[1]),s=Math.max(6,Math.round(37.5)),o=0,a=(i.lat-r.lat)/s,l=(i.lng-r.lng)/s,u=()=>{o++;let e=p().latLng(r.lat+a*o,r.lng+l*o);t.setLatLng(e),o<s&&requestAnimationFrame(u)};requestAnimationFrame(u)},[e]),i.jsx(l.J,{ref:e=>{n.current=e},position:e,icon:o})}p().Marker.prototype.options.icon=d;var h=r(448),v=r(7684);let b=null;function y({tripId:e}){let{driverLocation:t,trip:r}=function(e){let[t,r]=(0,s.useState)(!1),[i,n]=(0,s.useState)(null),[o,a]=(0,s.useState)(null),[l,u]=(0,s.useState)(null),c=(0,s.useRef)(null),p=(0,s.useRef)({}),d=(0,s.useRef)(null);function m(){d.current||(d.current=setTimeout(()=>{d.current=null,function(){let e=p.current;e.loc&&n(e.loc),e.trip&&a(t=>({...t||{},...e.trip})),void 0!==e.status&&u(e.status),p.current={}}()},200))}return(0,s.useEffect)(()=>{if(!e)return;let t=function(){if(b)return b;let e=process.env.NEXT_PUBLIC_API_WS||"http://localhost:3001";return b=(0,h.io)(e,{auth:{token:v.t.get("sisimove_token")}})}();c.current=t;let i=()=>{r(!0),t.emit("subscribe:trip",{tripId:e}),t.emit("get:trip",{tripId:e})},s=()=>{r(!1)},n=e=>{let t=function(e){if(!e)return null;let t=Number(e.lat??e.latitude??e.lat_gps),r=Number(e.lng??e.longitude??e.lng_gps),i=e.ts??e.time??new Date().toISOString();return Number.isNaN(t)||Number.isNaN(r)?null:{lat:t,lng:r,ts:i,driverId:e.driverId??e.driver_id??e.driver?.id}}(e);t&&(p.current.loc=t,m())},o=e=>{let t=e?{id:e.id??e.tripId??e.trip_id,status:e.status??e.state,driver:e.driver??e.driver_info,route:e.route??e.polyline??e.path}:null;t&&(p.current.trip=t,m())},a=e=>{let t=e?.status??e??null;p.current.status=t,m()};return t.on("connect",i),t.on("disconnect",s),t.on("driver:location",n),t.on("trip:update",o),t.on("trip:status",a),()=>{try{t.emit("unsubscribe:trip",{tripId:e})}catch{}t.off("connect",i),t.off("disconnect",s),t.off("driver:location",n),t.off("trip:update",o),t.off("trip:status",a),d.current&&(clearTimeout(d.current),d.current=null),c.current=null}},[e]),{connected:t,driverLocation:i,trip:o,status:l,socket:c.current}}(e),n=t?[t.lat,t.lng]:r?.origin?.lat?[r.origin.lat,r.origin.lng]:[0,0];return i.jsx("div",{className:"h-96 rounded overflow-hidden shadow",children:i.jsx(f,{center:n,zoom:13,autoFollow:!0,followPosition:t?[t.lat,t.lng]:null,children:t&&i.jsx(g,{position:[t.lat,t.lng]})})})}},6699:(e,t,r)=>{"use strict";r.r(t),r.d(t,{default:()=>l,metadata:()=>a});var i=r(7469),s=r(4215),n=r(437);let o=(0,s.default)(()=>r.e(47).then(r.bind(r,47)),{loadableGenerated:{modules:["C:\\Users\\HP\\sisimovego\\apps\\web\\src\\app\\trip\\[tripId]\\realtime\\page.tsx -> ./ClientWrapper"]},ssr:!1}),a=(0,n.Z)({title:"Trip realtime"});function l({params:e}){let t=e.tripId;return(0,i.jsxs)("div",{className:"max-w-4xl mx-auto p-6",children:[i.jsx("h1",{className:"text-2xl font-semibold",children:"Live trip tracking"}),i.jsx("div",{className:"mt-4",children:i.jsx(o,{tripId:t})})]})}},437:(e,t,r)=>{"use strict";function i({title:e,description:t,url:r,image:i}){let s="SisiMove â€” Africa-first ridesharing";return{title:e?`${e} | SisiMove`:s,description:t??"Book intercity and intra-city trips across Africa. Fast, safe, affordable.",metadataBase:new URL("https://sisimove.com"),openGraph:{title:e?`${e} | SisiMove`:s,description:t??"Book intercity and intra-city trips across Africa. Fast, safe, affordable.",url:r??"/",siteName:s,images:[{url:i??"/icons/icon-512.png",width:1200,height:630,alt:"SisiMove Preview"}],type:"website"},twitter:{card:"summary_large_image",title:e?`${e} | SisiMove`:s,description:t??"Book intercity and intra-city trips across Africa. Fast, safe, affordable.",images:[i??"/icons/icon-512.png"]}}}r.d(t,{Z:()=>i})}};var t=require("../../../../webpack-runtime.js");t.C(e);var r=e=>t(t.s=e),i=t.X(0,[875,691,108],()=>r(5052));module.exports=i})();