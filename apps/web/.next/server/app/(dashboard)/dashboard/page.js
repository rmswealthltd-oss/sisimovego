(()=>{var e={};e.id=903,e.ids=[903],e.modules={7849:e=>{"use strict";e.exports=require("next/dist/client/components/action-async-storage.external")},2934:e=>{"use strict";e.exports=require("next/dist/client/components/action-async-storage.external.js")},5403:e=>{"use strict";e.exports=require("next/dist/client/components/request-async-storage.external")},4580:e=>{"use strict";e.exports=require("next/dist/client/components/request-async-storage.external.js")},4749:e=>{"use strict";e.exports=require("next/dist/client/components/static-generation-async-storage.external")},5869:e=>{"use strict";e.exports=require("next/dist/client/components/static-generation-async-storage.external.js")},399:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},5647:(e,s,t)=>{"use strict";t.r(s),t.d(s,{GlobalError:()=>l.a,__next_app__:()=>m,originalPathname:()=>x,pages:()=>c,routeModule:()=>u,tree:()=>d});var r=t(117),a=t(2994),i=t(4898),l=t.n(i),n=t(6083),o={};for(let e in n)0>["default","tree","pages","GlobalError","originalPathname","__next_app__","routeModule"].indexOf(e)&&(o[e]=()=>n[e]);t.d(s,o);let d=["",{children:["(dashboard)",{children:["dashboard",{children:["__PAGE__",{},{page:[()=>Promise.resolve().then(t.bind(t,9435)),"C:\\Users\\HP\\sisimovego\\apps\\web\\src\\app\\(dashboard)\\dashboard\\page.tsx"]}]},{layout:[()=>Promise.resolve().then(t.bind(t,2697)),"C:\\Users\\HP\\sisimovego\\apps\\web\\src\\app\\(dashboard)\\dashboard\\layout.tsx"]}]},{"not-found":[()=>Promise.resolve().then(t.t.bind(t,8658,23)),"next/dist/client/components/not-found-error"]}]},{layout:[()=>Promise.resolve().then(t.bind(t,1255)),"C:\\Users\\HP\\sisimovego\\apps\\web\\src\\app\\layout.tsx"],"not-found":[()=>Promise.resolve().then(t.t.bind(t,8658,23)),"next/dist/client/components/not-found-error"]}],c=["C:\\Users\\HP\\sisimovego\\apps\\web\\src\\app\\(dashboard)\\dashboard\\page.tsx"],x="/(dashboard)/dashboard/page",m={require:t,loadChunk:()=>Promise.resolve()},u=new r.AppPageRouteModule({definition:{kind:a.x.APP_PAGE,page:"/(dashboard)/dashboard/page",pathname:"/dashboard",bundlePath:"",filename:"",appPaths:[]},userland:{loaderTree:d}})},1955:(e,s,t)=>{Promise.resolve().then(t.bind(t,2020))},6358:(e,s,t)=>{Promise.resolve().then(t.bind(t,4908))},2020:(e,s,t)=>{"use strict";t.r(s),t.d(s,{default:()=>f});var r=t(2281),a=t(2493),i=t(9339),l=t(7677),n=t(1932),o=t(8603),d=t(1893);let c=(0,a.createContext)({role:null,setRole:()=>{}});function x({children:e}){let{user:s}=(0,d.a)(),[t,i]=(0,a.useState)(null);return(0,a.useEffect)(()=>{if(!s){i(null);return}"admin@sisimove.com"===s.email?i("admin"):i("passenger")},[s]),r.jsx(c.Provider,{value:{role:t,setRole:i},children:e})}function m(){return(0,a.useContext)(c)}function u({open:e,onClose:s}){let t=(0,n.usePathname)(),{user:a,logout:c}=(0,d.a)(),{role:x}=m(),u=[{name:"Dashboard",href:"/dashboard",icon:o.m6D},{name:"Search Trips",href:"/dashboard/search",icon:o.i63},{name:"Post a Trip",href:"/dashboard/post-trip",icon:o.xVi,roles:["driver","admin"]},{name:"My Trips",href:"/dashboard/my-trips",icon:o.i63,roles:["passenger","driver"]},{name:"Profile",href:"/dashboard/profile",icon:o.fzv},{name:"Notifications",href:"/dashboard/notifications",icon:o.vWP},{name:"Settings",href:"/dashboard/settings",icon:o.nbt,roles:["admin"]}];return(0,r.jsxs)(r.Fragment,{children:[e&&r.jsx("div",{onClick:s,className:"fixed inset-0 bg-black/40 backdrop-blur-sm z-40 md:hidden"}),(0,r.jsxs)("aside",{className:(0,i.Z)("fixed z-50 inset-y-0 left-0 w-64 bg-white shadow-xl border-r border-gray-200 flex flex-col transition-transform duration-300",e?"translate-x-0":"-translate-x-full md:translate-x-0"),children:[(0,r.jsxs)("div",{className:"flex items-center justify-between px-6 py-5 border-b border-gray-200",children:[r.jsx("h1",{className:"text-xl font-semibold text-orange-500",children:"SisiMove"}),r.jsx("button",{onClick:s,className:"md:hidden text-gray-600 hover:text-orange-500",children:r.jsx(o.q5L,{size:22})})]}),(0,r.jsxs)("div",{className:"px-6 py-5 border-b border-gray-200",children:[r.jsx("p",{className:"text-lg font-medium text-gray-900",children:a?.lastName||"Guest User"}),r.jsx("p",{className:"text-sm text-gray-500",children:a?.email||"Not logged in"}),x&&r.jsx("span",{className:"mt-1 inline-block text-xs px-2 py-1 rounded-md bg-gray-100 text-gray-600 capitalize",children:x})]}),r.jsx("nav",{className:"flex-1 overflow-y-auto py-4",children:u.filter(e=>!e.roles||e.roles.includes(x||"")).map(e=>{let a=t===e.href,n=e.icon;return(0,r.jsxs)(l.default,{href:e.href,className:(0,i.Z)("flex items-center gap-3 px-6 py-3 text-sm font-medium transition rounded-md",a?"bg-orange-500 text-white shadow-md":"text-gray-700 hover:bg-gray-100"),onClick:s,children:[r.jsx(n,{size:18}),e.name]},e.href)})}),a&&r.jsx("div",{className:"p-6 border-t border-gray-200",children:(0,r.jsxs)("button",{onClick:c,className:"flex items-center gap-3 text-red-600 font-medium hover:text-red-800 transition",children:[r.jsx(o.xqh,{size:18}),"Logout"]})})]})]})}function p({onOpenSidebar:e}){let{user:s,logout:t,loading:a}=(0,d.a)(),{role:i}=m();return a?r.jsx("header",{className:"w-full h-16 bg-white border-b shadow-sm"}):r.jsx("header",{className:"w-full bg-white border-b shadow-sm h-16 flex items-center sticky top-0 z-40",children:(0,r.jsxs)("div",{className:"flex items-center justify-between w-full px-4 md:px-6",children:[r.jsx("button",{onClick:e,className:"md:hidden p-2 rounded-md border bg-gray-100 hover:bg-gray-200",children:r.jsx(o.cur,{size:22})}),r.jsx("h1",{className:"font-semibold text-lg text-gray-800",children:"Dashboard"}),(0,r.jsxs)("div",{className:"flex items-center gap-4",children:[i&&r.jsx("span",{className:"text-xs px-2 py-1 rounded-md bg-gray-100 text-gray-600 capitalize",children:i}),s&&r.jsx("span",{className:"text-sm font-medium text-gray-700",children:s.lastName}),s&&r.jsx("button",{onClick:t,className:"text-sm px-3 py-1 rounded-md bg-red-500 text-white hover:bg-red-600 transition",children:"Logout"})]})]})})}let h=(0,a.createContext)({notification:null,show:()=>{},clear:()=>{}});function g({children:e}){let[s,t]=(0,a.useState)(null);return r.jsx(h.Provider,{value:{notification:s,show:function(e,s){t({type:e,message:s}),setTimeout(()=>t(null),5e3)},clear:function(){t(null)}},children:e})}function f({children:e}){let[s,t]=(0,a.useState)(!1);return r.jsx(d.H,{children:r.jsx(x,{children:r.jsx(g,{children:(0,r.jsxs)("div",{className:"flex min-h-screen bg-gray-50",children:[r.jsx(u,{open:s,onClose:()=>t(!1)}),(0,r.jsxs)("div",{className:(0,i.Z)("flex flex-col flex-1 transition-all duration-200",s?"md:ml-64":"md:ml-0"),children:[r.jsx(p,{onOpenSidebar:()=>t(!0)}),r.jsx("main",{className:"p-6 w-full max-w-7xl mx-auto",children:e})]})]})})})})}},4908:(e,s,t)=>{"use strict";t.r(s),t.d(s,{default:()=>u});var r,a,i=t(2281),l=t(2493),n=t(1932),o=t(2020),d=t(3),c=t(8983),x=t(8603);function m({user:e}){let s=(0,n.useRouter)(),t="VERIFIED"===e.governmentIdStatus,r="PENDING"===e.governmentIdStatus,a="REJECTED"===e.governmentIdStatus,l="VERIFIED"===e.driverLicenseStatus,o="PENDING"===e.driverLicenseStatus,d="REJECTED"===e.driverLicenseStatus,c="DRIVER"===e.role;return t&&(!c||l)?null:(0,i.jsxs)("div",{className:"bg-yellow-50 border border-yellow-300 rounded-xl p-4 flex flex-col gap-3",children:[i.jsx("h2",{className:"font-semibold text-yellow-800 text-lg",children:"Complete Your Verification"}),!t&&(0,i.jsxs)("div",{className:"flex items-center justify-between",children:[(0,i.jsxs)("div",{children:[i.jsx("p",{className:"font-medium",children:"Government ID Verification"}),r&&i.jsx("p",{className:"text-sm text-gray-600",children:"Your ID is being reviewed…"}),a&&i.jsx("p",{className:"text-sm text-red-600",children:"Your ID was rejected. Please re-upload."})]}),r?i.jsx("span",{className:"text-xs text-gray-500 italic",children:"Pending"}):i.jsx("button",{onClick:()=>s.push("/profile/verify-id"),className:"px-4 py-1.5 bg-yellow-600 text-white rounded-lg text-sm hover:bg-yellow-700",children:a?"Re-upload ID":"Upload ID"})]}),c&&!l&&(0,i.jsxs)("div",{className:"flex items-center justify-between",children:[(0,i.jsxs)("div",{children:[i.jsx("p",{className:"font-medium",children:"Driver License Verification"}),o&&i.jsx("p",{className:"text-sm text-gray-600",children:"Your license is being reviewed…"}),d&&i.jsx("p",{className:"text-sm text-red-600",children:"License was rejected. Please re-upload."})]}),o?i.jsx("span",{className:"text-xs text-gray-500 italic",children:"Pending"}):i.jsx("button",{onClick:()=>s.push("/profile/verify-license"),className:"px-4 py-1.5 bg-yellow-600 text-white rounded-lg text-sm hover:bg-yellow-700",children:d?"Re-upload License":"Upload License"})]})]})}function u(){let e=(0,n.useRouter)(),{user:s,loading:t,token:u}=(0,d.a)(),[p,h]=(0,l.useState)(null),[g,f]=(0,l.useState)([]),[b,N]=(0,l.useState)([]),[y,j]=(0,l.useState)({totalTrips:0,completedTrips:0,totalEarnings:0});if((0,l.useEffect)(()=>{t||s||e.replace("/auth/login")},[t,s,e]),(0,l.useEffect)(()=>{u&&s&&(s.role===r.DRIVER&&"VERIFIED"===s.driverLicenseStatus&&(c.V.get("/drivers/wallet/me",{token:u}).then(e=>h(e.balance)).catch(()=>{}),c.V.get("/drivers/trips",{token:u}).then(e=>{N(e);let s=e.filter(e=>e.status===a.COMPLETED).length,t=e.filter(e=>e.status===a.COMPLETED).reduce((e,s)=>e+s.pricePerSeat*s.totalSeats,0);j({totalTrips:e.length,completedTrips:s,totalEarnings:t})}).catch(()=>{})),s.role===r.PASSENGER&&c.V.get("/passengers/bookings/my",{token:u}).then(f).catch(()=>{}))},[u,s]),t)return i.jsx("div",{children:"Loading…"});let v=({message:e})=>(0,i.jsxs)("div",{className:"flex flex-col items-center justify-center p-10 border border-dashed border-gray-300 rounded-xl text-gray-400 space-y-2",children:[i.jsx(x.H33,{className:"text-3xl"}),i.jsx("p",{children:e})]});return(0,i.jsxs)(o.default,{children:[s&&i.jsx(m,{user:s}),s?.role===r.DRIVER&&(0,i.jsxs)("div",{className:"grid grid-cols-1 sm:grid-cols-3 gap-6 mb-6",children:[(0,i.jsxs)("div",{className:"bg-white border rounded-xl shadow p-5 flex items-center gap-3",children:[i.jsx(x.C4B,{className:"text-primary text-2xl"}),(0,i.jsxs)("div",{children:[i.jsx("p",{className:"text-xs text-gray-500",children:"Total Trips"}),i.jsx("p",{className:"text-lg font-semibold",children:y.totalTrips})]})]}),(0,i.jsxs)("div",{className:"bg-white border rounded-xl shadow p-5 flex items-center gap-3",children:[i.jsx(x._rq,{className:"text-primary text-2xl"}),(0,i.jsxs)("div",{children:[i.jsx("p",{className:"text-xs text-gray-500",children:"Completed Trips"}),i.jsx("p",{className:"text-lg font-semibold",children:y.completedTrips})]})]}),(0,i.jsxs)("div",{className:"bg-white border rounded-xl shadow p-5 flex items-center gap-3",children:[i.jsx(x.oQC,{className:"text-primary text-2xl"}),(0,i.jsxs)("div",{children:[i.jsx("p",{className:"text-xs text-gray-500",children:"Total Earnings"}),(0,i.jsxs)("p",{className:"text-lg font-semibold",children:["KES ",(y.totalEarnings/100).toFixed(2)]})]})]})]}),(0,i.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[s?.role===r.DRIVER&&"VERIFIED"===s.driverLicenseStatus&&(0,i.jsxs)("div",{className:"bg-white border rounded-xl shadow p-5",children:[(0,i.jsxs)("h3",{className:"font-semibold flex items-center gap-2 mb-1",children:[i.jsx(x.XiQ,{className:"text-primary"})," Wallet Balance"]}),i.jsx("p",{className:"text-2xl font-bold mt-2",children:null===p?"—":`KES ${(p/100).toFixed(2)}`})]}),(0,i.jsxs)("div",{className:"bg-white border rounded-xl shadow p-5",children:[(0,i.jsxs)("h3",{className:"font-semibold flex items-center gap-2 mb-3",children:[i.jsx(x.TCC,{className:"text-primary"})," Upcoming Bookings"]}),0===g.length?i.jsx(v,{message:"No upcoming bookings yet"}):i.jsx("ul",{className:"space-y-2",children:g.slice(0,5).map(e=>(0,i.jsxs)("li",{className:"text-sm border-b pb-2",children:[(0,i.jsxs)("p",{className:"font-medium",children:[e.trip.toLocation," → ",e.trip.fromLocation]}),i.jsx("p",{className:"text-xs text-gray-600",children:new Date(e.trip.departureAt).toLocaleString()})]},e.id))})]})]}),i.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-5 mt-6",children:0===b.length?i.jsx(v,{message:"No trips available yet"}):b.map(t=>(0,i.jsxs)("div",{className:"relative bg-white border rounded-xl shadow p-5",children:[(0,i.jsxs)("p",{className:"font-semibold",children:[t.toLocation," → ",t.fromLocation]}),i.jsx("span",{className:"text-xs inline-block px-2 py-1 bg-gray-100 rounded mt-2",children:t.status}),(0,i.jsxs)("div",{className:"absolute bottom-4 right-4",children:[s?.role===r.PASSENGER&&t.status===a.REQUESTING&&("VERIFIED"!==s.governmentIdStatus?i.jsx("button",{onClick:()=>e.push("/profile/verify-id"),className:"py-2 px-4 bg-yellow-500 text-white rounded-lg text-sm hover:bg-yellow-600",children:"Verify ID to Join Trip"}):i.jsx("button",{onClick:()=>e.push(`/trips/${t.id}`),className:"py-2 px-4 bg-primary text-white rounded-lg text-sm hover:bg-primary/90",children:"Join Trip"})),s?.role===r.DRIVER&&t.status===a.REQUESTING&&("VERIFIED"!==s.driverLicenseStatus?i.jsx("button",{onClick:()=>e.push("/profile/verify-license"),className:"py-2 px-4 bg-yellow-500 text-white rounded-lg text-sm hover:bg-yellow-600",children:"Verify License to Post Trip"}):i.jsx("button",{onClick:()=>e.push(`/trips/${t.id}`),className:"py-2 px-4 bg-primary text-white rounded-lg text-sm hover:bg-primary/90",children:"Post Trip"}))]})]},t.id))})]})}(function(e){e.DRIVER="DRIVER",e.PASSENGER="PASSENGER"})(r||(r={})),function(e){e.REQUESTING="REQUESTING",e.PENDING="PENDING",e.DRIVER_ASSIGNED="DRIVER_ASSIGNED",e.ONGOING="ONGOING",e.COMPLETED="COMPLETED",e.CANCELLED="CANCELLED"}(a||(a={}))},3:(e,s,t)=>{"use strict";t.d(s,{a:()=>n});var r=t(2493),a=t(1932),i=t(8983),l=t(7684);function n(){let e=(0,a.useRouter)(),[s,t]=(0,r.useState)(null),[n,o]=(0,r.useState)(null),[d,c]=(0,r.useState)(!0);(0,r.useEffect)(()=>{let e=l.t.get("token");e&&o(e),c(!1)},[]),(0,r.useEffect)(()=>{if(!n){t(null);return}x()},[n]);let x=(0,r.useCallback)(async()=>{if(n)try{let e=await i.V.get("/auth/me",{headers:{Authorization:`Bearer ${n}`}});t({...e,fullName:`${e.firstName} ${e.lastName}`})}catch{m()}},[n]),m=()=>{l.t.remove("token"),o(null),t(null),e.replace("/auth/login")};return{user:s,token:n,loading:d,login:async(s,r)=>{c(!0);try{let{token:a,user:n}=await i.V.post("/auth/login",{email:s,password:r});return l.t.set("token",a),o(a),t({...n,fullName:`${n.firstName} ${n.lastName}`}),e.replace("/dashboard"),!0}catch{return!1}finally{c(!1)}},register:async s=>{c(!0);try{let{token:r,user:a}=await i.V.post("/auth/register",s);return l.t.set("token",r),o(r),t({...a,fullName:`${a.firstName} ${a.lastName}`}),e.replace("/dashboard"),!0}catch{return!1}finally{c(!1)}},logout:m,refreshUser:x,setUser:t}}},2697:(e,s,t)=>{"use strict";t.r(s),t.d(s,{$$typeof:()=>i,__esModule:()=>a,default:()=>l});let r=(0,t(3610).createProxy)(String.raw`C:\Users\HP\sisimovego\apps\web\src\app\(dashboard)\dashboard\layout.tsx`),{__esModule:a,$$typeof:i}=r,l=r.default},9435:(e,s,t)=>{"use strict";t.r(s),t.d(s,{$$typeof:()=>i,__esModule:()=>a,default:()=>l});let r=(0,t(3610).createProxy)(String.raw`C:\Users\HP\sisimovego\apps\web\src\app\(dashboard)\dashboard\page.tsx`),{__esModule:a,$$typeof:i}=r,l=r.default},9339:(e,s,t)=>{"use strict";t.d(s,{Z:()=>r});let r=function(){for(var e,s,t=0,r="",a=arguments.length;t<a;t++)(e=arguments[t])&&(s=function e(s){var t,r,a="";if("string"==typeof s||"number"==typeof s)a+=s;else if("object"==typeof s){if(Array.isArray(s)){var i=s.length;for(t=0;t<i;t++)s[t]&&(r=e(s[t]))&&(a&&(a+=" "),a+=r)}else for(r in s)s[r]&&(a&&(a+=" "),a+=r)}return a}(e))&&(r&&(r+=" "),r+=s);return r}}};var s=require("../../../webpack-runtime.js");s.C(e);var t=e=>s(s.s=e),r=s.X(0,[49,108],()=>t(5647));module.exports=r})();