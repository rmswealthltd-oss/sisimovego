(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[721],{4439:function(e,t,r){Promise.resolve().then(r.bind(r,9367)),Promise.resolve().then(r.bind(r,1987))},9367:function(e,t,r){"use strict";r.r(t),r.d(t,{default:function(){return l}});var n=r(6543),o=r(5729),s=r(187),i=r(615);let a=(0,r(2651).Z)("check",[["path",{d:"M20 6 9 17l-5-5",key:"1gmf2c"}]]);var c=r(7221);function u(e){let{value:t,label:r,description:o,selected:s,onSelect:i}=e,u=s===t;return(0,n.jsxs)("div",{onClick:()=>i(t),className:(0,c.Z)("flex items-center justify-between p-4 rounded-xl border cursor-pointer transition",u?"border-primary bg-primary/5":"hover:bg-gray-50 border-gray-300"),children:[(0,n.jsxs)("div",{children:[(0,n.jsx)("div",{className:"font-medium",children:r}),o&&(0,n.jsx)("div",{className:"text-sm text-gray-600",children:o})]}),u&&(0,n.jsx)(a,{className:"text-primary",strokeWidth:2})]})}function l(e){let{booking:t}=e,[r,a]=(0,o.useState)("mpesa"),[c,l]=(0,o.useState)(!1),d=(0,i.useRouter)();async function h(){l(!0);try{let e=await s.V.createCheckout({bookingId:t.id,method:r});"mpesa"===r?d.push("/payments/mpesa?checkoutId=".concat(e.checkoutId)):"stripe"===r&&(e.redirectUrl?window.location.href=e.redirectUrl:d.push("/payments/stripe?checkoutId=".concat(e.checkoutId)))}catch(e){alert((null==e?void 0:e.message)||"Checkout failed")}finally{l(!1)}}return(0,n.jsxs)("div",{className:"bg-white p-4 rounded shadow space-y-4",children:[(0,n.jsxs)("div",{className:"text-sm text-gray-500",children:["Booking: ",t.id]}),(0,n.jsxs)("div",{className:"text-lg font-semibold",children:["KES ",(t.totalCents/100).toFixed(2)]}),(0,n.jsxs)("div",{className:"space-y-2",children:[(0,n.jsx)(u,{value:"mpesa",label:"MPESA",description:"STK Push",selected:r,onSelect:a}),(0,n.jsx)(u,{value:"stripe",label:"Stripe",description:"Card / Apple Pay",selected:r,onSelect:a})]}),(0,n.jsx)("button",{disabled:c,onClick:h,className:"px-4 py-2 bg-primary text-white rounded",children:c?"Processing...":"Pay now"})]})}},187:function(e,t,r){"use strict";r.d(t,{V:function(){return s}});let n="http://localhost:3001".replace(/\/$/,"")||"http://localhost:5000";async function o(e,t,r){let o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{},s=localStorage.getItem("token"),i={"Content-Type":"application/json",...o.headers||{}};s&&(i.Authorization="Bearer ".concat(s));let a=await fetch("".concat(n).concat(t),{method:e,headers:i,body:r?JSON.stringify(r):void 0}),c=null;try{c=await a.json()}catch(e){c=null}if(!a.ok){let e=Error((null==c?void 0:c.message)||(null==c?void 0:c.error)||a.statusText);throw e.data=c,e.status=a.status,e}return c}let s={get(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return o("GET",e,void 0,t)},post(e,t){let r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return o("POST",e,t,r)},put(e,t){let r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return o("PUT",e,t,r)},patch(e,t){let r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return o("PATCH",e,t,r)},delete(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return o("DELETE",e,void 0,t)},getMe(){return this.get("/auth/me")},createBooking(e){return this.post("/bookings/create",e)},getBooking(e){return this.get("/bookings/".concat(encodeURIComponent(e)))},applyPromo(e){return this.post("/promos/apply",e)},createCheckout(e){return this.post("/payments/checkout",e)},getTrip(e){return this.get("/trips/".concat(e))},saveSubscription(e){return this.post("/push/subscribe",{subscription:e})},getSubscriptions(){return this.get("/push/subscriptions")},deleteSubscription(e){return this.delete("/push/subscriptions/".concat(encodeURIComponent(e)))}}},2651:function(e,t,r){"use strict";r.d(t,{Z:function(){return d}});var n=r(5729);/**
 * @license lucide-react v0.553.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let o=e=>e.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase(),s=e=>e.replace(/^([A-Z])|[\s-_]+(\w)/g,(e,t,r)=>r?r.toUpperCase():t.toLowerCase()),i=e=>{let t=s(e);return t.charAt(0).toUpperCase()+t.slice(1)},a=function(){for(var e=arguments.length,t=Array(e),r=0;r<e;r++)t[r]=arguments[r];return t.filter((e,t,r)=>!!e&&""!==e.trim()&&r.indexOf(e)===t).join(" ").trim()},c=e=>{for(let t in e)if(t.startsWith("aria-")||"role"===t||"title"===t)return!0};/**
 * @license lucide-react v0.553.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */var u={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};/**
 * @license lucide-react v0.553.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let l=(0,n.forwardRef)((e,t)=>{let{color:r="currentColor",size:o=24,strokeWidth:s=2,absoluteStrokeWidth:i,className:l="",children:d,iconNode:h,...p}=e;return(0,n.createElement)("svg",{ref:t,...u,width:o,height:o,stroke:r,strokeWidth:i?24*Number(s)/Number(o):s,className:a("lucide",l),...!d&&!c(p)&&{"aria-hidden":"true"},...p},[...h.map(e=>{let[t,r]=e;return(0,n.createElement)(t,r)}),...Array.isArray(d)?d:[d]])}),d=(e,t)=>{let r=(0,n.forwardRef)((r,s)=>{let{className:c,...u}=r;return(0,n.createElement)(l,{ref:s,iconNode:t,className:a("lucide-".concat(o(i(e))),"lucide-".concat(e),c),...u})});return r.displayName=i(e),r}},615:function(e,t,r){"use strict";var n=r(5411);r.o(n,"usePathname")&&r.d(t,{usePathname:function(){return n.usePathname}}),r.o(n,"useRouter")&&r.d(t,{useRouter:function(){return n.useRouter}})},1987:function(e,t,r){"use strict";function n(e){let{reason:t,children:r}=e;return r}Object.defineProperty(t,"__esModule",{value:!0}),Object.defineProperty(t,"BailoutToCSR",{enumerable:!0,get:function(){return n}}),r(3297)},7221:function(e,t,r){"use strict";t.Z=function(){for(var e,t,r=0,n="",o=arguments.length;r<o;r++)(e=arguments[r])&&(t=function e(t){var r,n,o="";if("string"==typeof t||"number"==typeof t)o+=t;else if("object"==typeof t){if(Array.isArray(t)){var s=t.length;for(r=0;r<s;r++)t[r]&&(n=e(t[r]))&&(o&&(o+=" "),o+=n)}else for(n in t)t[n]&&(o&&(o+=" "),o+=n)}return o}(e))&&(n&&(n+=" "),n+=t);return n}}},function(e){e.O(0,[585,682,744],function(){return e(e.s=4439)}),_N_E=e.O()}]);