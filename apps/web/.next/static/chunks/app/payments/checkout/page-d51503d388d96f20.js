(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[721],{4439:function(e,t,r){Promise.resolve().then(r.bind(r,9367)),Promise.resolve().then(r.bind(r,1987))},9367:function(e,t,r){"use strict";r.r(t),r.d(t,{default:function(){return l}});var n=r(6543),s=r(5729),i=r(187),o=r(615);let a=(0,r(2651).Z)("check",[["path",{d:"M20 6 9 17l-5-5",key:"1gmf2c"}]]);var u=r(7221);function c(e){let{value:t,label:r,description:s,selected:i,onSelect:o}=e,c=i===t;return(0,n.jsxs)("div",{onClick:()=>o(t),className:(0,u.Z)("flex items-center justify-between p-4 rounded-xl border cursor-pointer transition",c?"border-primary bg-primary/5":"hover:bg-gray-50 border-gray-300"),children:[(0,n.jsxs)("div",{children:[(0,n.jsx)("div",{className:"font-medium",children:r}),s&&(0,n.jsx)("div",{className:"text-sm text-gray-600",children:s})]}),c&&(0,n.jsx)(a,{className:"text-primary",strokeWidth:2})]})}function l(e){let{booking:t}=e,[r,a]=(0,s.useState)("mpesa"),[u,l]=(0,s.useState)(!1),d=(0,o.useRouter)();async function h(){l(!0);try{let e=await i.V.createCheckout({bookingId:t.id,method:r});"mpesa"===r?d.push("/payments/mpesa?checkoutId=".concat(e.checkoutId)):"stripe"===r&&(e.redirectUrl?window.location.href=e.redirectUrl:d.push("/payments/stripe?checkoutId=".concat(e.checkoutId)))}catch(e){alert((null==e?void 0:e.message)||"Checkout failed")}finally{l(!1)}}return(0,n.jsxs)("div",{className:"bg-white p-4 rounded shadow space-y-4",children:[(0,n.jsxs)("div",{className:"text-sm text-gray-500",children:["Booking: ",t.id]}),(0,n.jsxs)("div",{className:"text-lg font-semibold",children:["KES ",(t.amountCents/100).toFixed(2)]}),(0,n.jsxs)("div",{className:"space-y-2",children:[(0,n.jsx)(c,{value:"mpesa",label:"MPESA",description:"STK Push",selected:r,onSelect:a}),(0,n.jsx)(c,{value:"stripe",label:"Stripe",description:"Card / Apple Pay",selected:r,onSelect:a})]}),(0,n.jsx)("button",{disabled:u,onClick:h,className:"px-4 py-2 bg-primary text-white rounded",children:u?"Processing...":"Pay now"})]})}},187:function(e,t,r){"use strict";r.d(t,{V:function(){return o}});let n="http://localhost:3001".replace(/\/$/,"")||"http://localhost:3001",s="".concat(n,"/api");async function i(e,t){let r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},n={"Content-Type":"application/json",...r.headers||{}};r.token&&(n.Authorization="Bearer ".concat(r.token));let i=s+t+function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=new URLSearchParams;for(let r in e)void 0!==e[r]&&null!==e[r]&&t.append(r,e[r].toString());let r=t.toString();return r?"?".concat(r):""}(r.params),o=await fetch(i,{method:e,headers:n,credentials:"include",body:r.body?JSON.stringify(r.body):void 0}),a=null;try{a=await o.json()}catch(e){}if(!o.ok){let e=Error((null==a?void 0:a.message)||"Request failed");throw e.status=o.status,e.data=a,e}return a}let o={request:i,get(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return i("GET",e,t)},post(e,t){let r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return i("POST",e,{...r,body:t})},put(e,t){let r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return i("PUT",e,{...r,body:t})},patch(e,t){let r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return i("PATCH",e,{...r,body:t})},del(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return i("DELETE",e,t)},login(e,t){return this.post("/auth/login",{email:e,password:t})},logout(){return this.post("/auth/logout")},getMe(){return this.get("/auth/me")},getDriverTrips(){return this.get("/drivers/trips")},getDriverBookings(){return this.get("/drivers/bookings")},getWallet(){return this.get("/drivers/wallet/me")},getMyBookings(){return this.get("/passengers/bookings/my")},createBooking(e){return this.post("/passengers/bookings",e)},cancelBooking(e,t){return this.post("/passengers/bookings/cancel",{bookingId:e,reason:t})},getTrips(e){return this.get("/trips",{params:e})},postTrip(e){return this.post("/trips",e)},getSubscriptions(){return this.get("/push/subscription")},saveSubscription(e){return this.post("/push/subscription",{subscription:e})},deleteSubscription(e){return this.del("/push/subscription/".concat(e))},createCheckout(e){return this.post("/passengers/payments/checkout",e)},getPayment(e){return this.get("/payments/".concat(e))},getPaymentsForBooking(e){return this.get("/passengers/bookings/".concat(e,"/payments"))}}},2651:function(e,t,r){"use strict";r.d(t,{Z:function(){return d}});var n=r(5729);/**
 * @license lucide-react v0.553.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let s=e=>e.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase(),i=e=>e.replace(/^([A-Z])|[\s-_]+(\w)/g,(e,t,r)=>r?r.toUpperCase():t.toLowerCase()),o=e=>{let t=i(e);return t.charAt(0).toUpperCase()+t.slice(1)},a=function(){for(var e=arguments.length,t=Array(e),r=0;r<e;r++)t[r]=arguments[r];return t.filter((e,t,r)=>!!e&&""!==e.trim()&&r.indexOf(e)===t).join(" ").trim()},u=e=>{for(let t in e)if(t.startsWith("aria-")||"role"===t||"title"===t)return!0};/**
 * @license lucide-react v0.553.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */var c={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};/**
 * @license lucide-react v0.553.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let l=(0,n.forwardRef)((e,t)=>{let{color:r="currentColor",size:s=24,strokeWidth:i=2,absoluteStrokeWidth:o,className:l="",children:d,iconNode:h,...p}=e;return(0,n.createElement)("svg",{ref:t,...c,width:s,height:s,stroke:r,strokeWidth:o?24*Number(i)/Number(s):i,className:a("lucide",l),...!d&&!u(p)&&{"aria-hidden":"true"},...p},[...h.map(e=>{let[t,r]=e;return(0,n.createElement)(t,r)}),...Array.isArray(d)?d:[d]])}),d=(e,t)=>{let r=(0,n.forwardRef)((r,i)=>{let{className:u,...c}=r;return(0,n.createElement)(l,{ref:i,iconNode:t,className:a("lucide-".concat(s(o(e))),"lucide-".concat(e),u),...c})});return r.displayName=o(e),r}},615:function(e,t,r){"use strict";var n=r(5411);r.o(n,"usePathname")&&r.d(t,{usePathname:function(){return n.usePathname}}),r.o(n,"useRouter")&&r.d(t,{useRouter:function(){return n.useRouter}})},1987:function(e,t,r){"use strict";function n(e){let{reason:t,children:r}=e;return r}Object.defineProperty(t,"__esModule",{value:!0}),Object.defineProperty(t,"BailoutToCSR",{enumerable:!0,get:function(){return n}}),r(3297)},7221:function(e,t,r){"use strict";t.Z=function(){for(var e,t,r=0,n="",s=arguments.length;r<s;r++)(e=arguments[r])&&(t=function e(t){var r,n,s="";if("string"==typeof t||"number"==typeof t)s+=t;else if("object"==typeof t){if(Array.isArray(t)){var i=t.length;for(r=0;r<i;r++)t[r]&&(n=e(t[r]))&&(s&&(s+=" "),s+=n)}else for(n in t)t[n]&&(s&&(s+=" "),s+=n)}return s}(e))&&(n&&(n+=" "),n+=t);return n}}},function(e){e.O(0,[585,682,744],function(){return e(e.s=4439)}),_N_E=e.O()}]);