"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[805],{6175:function(t,e,r){r.d(e,{a:function(){return i}});var n=r(5729),o=r(615),a=r(187),s=r(148);function i(){let t=(0,o.useRouter)(),[e,r]=(0,n.useState)(null),[i,l]=(0,n.useState)(null),[u,c]=(0,n.useState)(!0);(0,n.useEffect)(()=>{let t=s.t.get("token");t&&l(t),c(!1)},[]),(0,n.useEffect)(()=>{if(!i){r(null);return}p()},[i]);let p=(0,n.useCallback)(async()=>{if(i)try{let t=await a.V.get("/auth/me",{headers:{Authorization:"Bearer ".concat(i)}});r({...t,fullName:"".concat(t.firstName," ").concat(t.lastName)})}catch(t){g()}},[i]),g=()=>{s.t.remove("token"),l(null),r(null),t.replace("/auth/login")};return{user:e,token:i,loading:u,login:async(e,n)=>{c(!0);try{let{token:o,user:i}=await a.V.post("/auth/login",{email:e,password:n});return s.t.set("token",o),l(o),r({...i,fullName:"".concat(i.firstName," ").concat(i.lastName)}),t.replace("/dashboard"),!0}catch(t){return!1}finally{c(!1)}},register:async e=>{c(!0);try{let{token:n,user:o}=await a.V.post("/auth/register",e);return s.t.set("token",n),l(n),r({...o,fullName:"".concat(o.firstName," ").concat(o.lastName)}),t.replace("/dashboard"),!0}catch(t){return!1}finally{c(!1)}},logout:g,refreshUser:p,setUser:r}}},187:function(t,e,r){r.d(e,{V:function(){return s}});let n="http://localhost:3001".replace(/\/$/,"")||"http://localhost:3001",o="".concat(n,"/api");async function a(t,e){let r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},n={"Content-Type":"application/json",...r.headers||{}};r.token&&(n.Authorization="Bearer ".concat(r.token));let a=o+e+function(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=new URLSearchParams;for(let r in t)void 0!==t[r]&&null!==t[r]&&e.append(r,t[r].toString());let r=e.toString();return r?"?".concat(r):""}(r.params),s=await fetch(a,{method:t,headers:n,credentials:"include",body:r.body?JSON.stringify(r.body):void 0}),i=null;try{i=await s.json()}catch(t){}if(!s.ok){let t=Error((null==i?void 0:i.message)||"Request failed");throw t.status=s.status,t.data=i,t}return i}let s={request:a,get(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return a("GET",t,e)},post(t,e){let r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return a("POST",t,{...r,body:e})},put(t,e){let r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return a("PUT",t,{...r,body:e})},patch(t,e){let r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return a("PATCH",t,{...r,body:e})},del(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return a("DELETE",t,e)},login(t,e){return this.post("/auth/login",{email:t,password:e})},logout(){return this.post("/auth/logout")},getMe(){return this.get("/auth/me")},getDriverTrips(){return this.get("/drivers/trips")},getDriverBookings(){return this.get("/drivers/bookings")},getWallet(){return this.get("/drivers/wallet/me")},getMyBookings(){return this.get("/passengers/bookings/my")},createBooking(t){return this.post("/passengers/bookings",t)},cancelBooking(t,e){return this.post("/passengers/bookings/cancel",{bookingId:t,reason:e})},getTrips(t){return this.get("/trips",{params:t})},postTrip(t){return this.post("/trips",t)},getSubscriptions(){return this.get("/push/subscription")},saveSubscription(t){return this.post("/push/subscription",{subscription:t})},deleteSubscription(t){return this.del("/push/subscription/".concat(t))},createCheckout(t){return this.post("/passengers/payments/checkout",t)},getPayment(t){return this.get("/payments/".concat(t))},getPaymentsForBooking(t){return this.get("/passengers/bookings/".concat(t,"/payments"))}}},148:function(t,e,r){r.d(e,{t:function(){return n}});let n={set(t,e){try{"string"==typeof e?localStorage.setItem(t,e):localStorage.setItem(t,JSON.stringify(e))}catch(t){console.error("storage.set error:",t)}},get(t){try{let e=localStorage.getItem(t);if(!e)return null;if(e.startsWith("{")||e.startsWith("[")||"null"===e)return JSON.parse(e);return e}catch(t){return console.error("storage.get error:",t),null}},remove(t){try{localStorage.removeItem(t)}catch(t){console.error("storage.remove error:",t)}}}},615:function(t,e,r){var n=r(5411);r.o(n,"usePathname")&&r.d(e,{usePathname:function(){return n.usePathname}}),r.o(n,"useRouter")&&r.d(e,{useRouter:function(){return n.useRouter}})},1118:function(t,e,r){r.d(e,{w_:function(){return c}});var n=r(5729),o={color:void 0,size:void 0,className:void 0,style:void 0,attr:void 0},a=n.createContext&&n.createContext(o),s=["attr","size","title"];function i(){return(i=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(t[n]=r[n])}return t}).apply(this,arguments)}function l(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable})),r.push.apply(r,n)}return r}function u(t){for(var e=1;e<arguments.length;e++){var r=null!=arguments[e]?arguments[e]:{};e%2?l(Object(r),!0).forEach(function(e){var n,o;n=e,o=r[e],(n=function(t){var e=function(t,e){if("object"!=typeof t||!t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var n=r.call(t,e||"default");if("object"!=typeof n)return n;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==typeof e?e:e+""}(n))in t?Object.defineProperty(t,n,{value:o,enumerable:!0,configurable:!0,writable:!0}):t[n]=o}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):l(Object(r)).forEach(function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(r,e))})}return t}function c(t){return e=>n.createElement(p,i({attr:u({},t.attr)},e),function t(e){return e&&e.map((e,r)=>n.createElement(e.tag,u({key:r},e.attr),t(e.child)))}(t.child))}function p(t){var e=e=>{var r,{attr:o,size:a,title:l}=t,c=function(t,e){if(null==t)return{};var r,n,o=function(t,e){if(null==t)return{};var r={};for(var n in t)if(Object.prototype.hasOwnProperty.call(t,n)){if(e.indexOf(n)>=0)continue;r[n]=t[n]}return r}(t,e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(t);for(n=0;n<a.length;n++)r=a[n],!(e.indexOf(r)>=0)&&Object.prototype.propertyIsEnumerable.call(t,r)&&(o[r]=t[r])}return o}(t,s),p=a||e.size||"1em";return e.className&&(r=e.className),t.className&&(r=(r?r+" ":"")+t.className),n.createElement("svg",i({stroke:"currentColor",fill:"currentColor",strokeWidth:"0"},e.attr,o,c,{className:r,style:u(u({color:t.color||e.color},e.style),t.style),height:p,width:p,xmlns:"http://www.w3.org/2000/svg"}),l&&n.createElement("title",null,l),t.children)};return void 0!==a?n.createElement(a.Consumer,null,t=>e(t)):e(o)}}}]);